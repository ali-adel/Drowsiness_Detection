<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drowsiness Detection</title>
    <link rel="stylesheet" href="/static/style.css"> <!-- Link to external CSS -->
</head>
<body>
    <div class="header">
        <div class="logo-title">
            <img src="/image/logo.png" alt="Logo" class="logo"> <!-- Update the logo path -->
            <h1>H O R</h1>
        </div>
        
        <nav>
            <a href="#home">Home</a>
            <a href="#services">Services</a>
            <a href="#about">About</a>
            <a href="#detection">Detection</a>
        </nav>
    </div>
    
    <section id="home" class="welcome">
        <!-- Video Background -->
        <video id="background-video" autoplay loop muted playsinline>
            <source src="http://127.0.0.1:8000/video" type="video/mp4" />
        </video>

        <h2>
            <span>Welcome to H O R</span><br>
            <span>Our Drowsiness Detection System</span>
        </h2>
        <p>
            Our advanced Drowsiness Detection System employs cutting-edge technology to monitor driver alertness and reduce the risk of accidents caused by fatigue. Utilizing real-time facial recognition and behavioral analysis, our system detects signs of drowsiness and alerts drivers through audio and visual warnings. By integrating seamlessly with vehicles, we aim to enhance road safety and provide a reliable solution for preventing fatigue-related incidents. Trust H O R to keep you and your loved ones safe on the road.
        </p>
    </section>
    
    <section id="services">
        <h2>Our Services</h2>
        <div class="services">
            <div class="service-card">
                <img src="/image/img2.jpeg" alt="Morning Detection">
                <h3>Morning Detection</h3>
                <p>Detect drowsiness in the early hours with our advanced morning detection technology, ensuring you stay alert on the road.</p>
            </div>
            <div class="service-card">
                <img src="/image/img3.jpeg" alt="Night Detection">
                <h3>Night Detection</h3>
                <p>Stay safe during nighttime driving with our cutting-edge detection solutions tailored for low-light conditions.</p>
            </div>
            <div class="service-card">
                <img src="/image/img4.jpeg" alt="Emergency Alert">
                <h3>Emergency Alert</h3>
                <p>In case of drowsiness, our system sends emergency alerts to prevent accidents and ensure your safety.</p>
            </div>
        </div>
    </section>

    <section id="about">
        <h2>About Us</h2>
        <p>
            H O R is dedicated to developing innovative solutions for driver safety. Our team of experts combines technology and research to create effective drowsiness detection systems, providing peace of mind on the road. We are committed to enhancing road safety through reliable and efficient solutions.
        </p>
    </section>

    <section id="detection" class="form-section">
        <h2>Drowsiness Detection Upload</h2>
        <p>Upload an image for drowsiness detection:</p>
    
        <label for="imageInput" class="custum-file-upload">
            <div class="icon">
                <svg viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M10 1C9.73478 1 9.48043 1.10536 9.29289 1.29289L3.29289 7.29289C3.10536 7.48043 3 7.73478 3 8V20C3 21.6569 4.34315 23 6 23H7C7.55228 23 8 22.5523 8 22C8 21.4477 7.55228 21 7 21H6C5.44772 21 5 20.5523 5 20V9H10C10.5523 9 11 8.55228 11 8V3H18C18.5523 3 19 3.44772 19 4V9C19 9.55228 19.4477 10 20 10C20.5523 10 21 9.55228 21 9V4C21 2.34315 19.6569 1 18 1H10ZM9 7H6.41421L9 4.41421V7ZM14 15.5C14 14.1193 15.1193 13 16.5 13C17.8807 13 19 14.1193 19 15.5V16V17H20C21.1046 17 22 17.8954 22 19C22 20.1046 21.1046 21 20 21H13C11.8954 21 11 20.1046 11 19C11 17.8954 11.8954 17 13 17H14V16V15.5ZM16.5 11C14.142 11 12.2076 12.8136 12.0156 15.122C10.2825 15.5606 9 17.1305 9 19C9 21.2091 10.7909 23 13 23H20C22.2091 23 24 21.2091 24 19C24 17.1305 22.7175 15.5606 20.9844 15.122C20.7924 12.8136 18.858 11 16.5 11Z"></path>
                </svg>
            </div>
            <div class="text">
                <span>Click to upload image</span>
            </div>
            <input id="imageInput" type="file" name="file" accept="image/*" required>
        </label>
    
        <!-- Replace this button with the new button -->
        <button class="btn">
            <svg height="24" width="24" fill="#FFFFFF" viewBox="0 0 24 24" data-name="Layer 1" id="Layer_1" class="sparkle">
                <path d="M10,21.236,6.755,14.745.264,11.5,6.755,8.255,10,1.764l3.245,6.491L19.736,11.5l-6.491,3.245ZM18,21l1.5,3L21,21l3-1.5L21,18l-1.5-3L18,18l-3,1.5ZM19.333,4.667,20.5,7l1.167-2.333L24,3.5,21.667,2.333,20.5,0,19.333,2.333,17,3.5Z"></path>
            </svg>
            <span class="text">Detect Drowsiness</span>
        </button>
        
        <div class="spinner" id="loadingSpinner" style="display:none;"></div>
        <img id="predicted-image" src="" alt="Predicted Result" style="display: none;">
    </section>
    
    <script>
// For Image Upload
document.querySelector('.btn').addEventListener('click', async (event) => {
    event.preventDefault();
    
    const inputFile = document.getElementById('imageInput');
    const loadingSpinner = document.getElementById('loadingSpinner');
    const predictedImage = document.getElementById('predicted-image');
    
    if (inputFile.files.length === 0) {
        alert('Please upload an image.');
        return;
    }
    
    const formData = new FormData();
    formData.append('file', inputFile.files[0]);
    
    loadingSpinner.style.display = 'block';
    
    try {
        const response = await fetch('/predict/yolo/', {  // Ensure this matches the FastAPI endpoint
            method: 'POST',
            body: formData
        });

        if (!response.ok) {
            throw new Error('Network response was not ok.');
        }

        const data = await response.json();
        
        loadingSpinner.style.display = 'none';
        
        predictedImage.src = data.image_url;
        predictedImage.style.display = 'block';

        console.log(data.predictions);
    } catch (error) {
        loadingSpinner.style.display = 'none';
        console.error('There was a problem with your fetch operation:', error);
        alert('An error occurred while processing the image. Please try again.');
    }
});

// For Video Upload (if you have a separate button for video)
document.querySelector('.video-btn').addEventListener('click', async (event) => {
    event.preventDefault();

    const videoFile = document.getElementById('videoInput');
    const loadingSpinner = document.getElementById('loadingSpinner');

    if (videoFile.files.length === 0) {
        alert('Please upload a video.');
        return;
    }

    const formData = new FormData();
    formData.append('file', videoFile.files[0]);

    loadingSpinner.style.display = 'block';

    try {
        const response = await fetch('/predict/yolo/video/', {  // Ensure this matches the FastAPI endpoint
            method: 'POST',
            body: formData
        });

        if (!response.ok) {
            throw new Error('Network response was not ok.');
        }

        const data = await response.json();

        loadingSpinner.style.display = 'none';

        alert('Video processed! You can view it here: ' + data.video_url);
    } catch (error) {
        loadingSpinner.style.display = 'none';
        console.error('There was a problem with your fetch operation:', error);
        alert('An error occurred while processing the video. Please try again.');
    }
});
    </script>
</body>
</html>
